<br><h4><b>I.	Condition based templates deployment</h3></b>
<p>You can link to different templates by passing in a  parameter value that is used to construct the URI of the linked template. This  approach works well when you need to specify during deployment the linked  template to use. For example, you can specify one template to use for an  existing storage account, and another template to use for a new storage  account.</p>
<p>The following example shows a parameter for a storage  account name, and a parameter to specify whether the storage account is new or  existing.<br>
<div>
  <blockquote>
    <p>&quot;parameters&quot;: { <br>
      &nbsp;&nbsp;&nbsp;      &quot;storageAccountName&quot;: { <br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      &quot;type&quot;: &quot;String&quot; <br>
      &nbsp;&nbsp;&nbsp; }, <br>
      &nbsp;&nbsp;&nbsp;      &quot;newOrExisting&quot;: { <br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      &quot;type&quot;: &quot;String&quot;, <br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      &quot;allowedValues&quot;: [ <br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      &quot;new&quot;, <br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      &quot;existing&quot; <br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ] <br>
      &nbsp;&nbsp;&nbsp; } <br>
      },&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </p>
  </blockquote>
</div>
</p>
<br><p>You create a variable for the template URI  that includes the value of the new or existing parameter<br>
</p>
<div>
  <blockquote>
    <p>&quot;variables&quot;: { <br>
      &nbsp;&nbsp;&nbsp;      &quot;templatelink&quot;:      &quot;[concat('https://raw.githubusercontent.com/exampleuser/templates/master/',parameters('newOrExisting'),'StorageAccount.json')]&quot; <br>
      },&nbsp;&nbsp; </p>
  </blockquote>
</div>
<p>&nbsp;</p>
<br><p>You provide that variable value for the  deployment resource<br>
<div>
  <blockquote>
    <p>&quot;resources&quot;: [ <br>
      &nbsp;&nbsp;&nbsp; { <br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      &quot;apiVersion&quot;: &quot;2015-01-01&quot;, <br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      &quot;name&quot;: &quot;linkedTemplate&quot;, <br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      &quot;type&quot;: &quot;Microsoft.Resources/deployments&quot;,&nbsp;&nbsp; <br>
      &quot;properties&quot;: { <br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      &quot;mode&quot;: &quot;incremental&quot;, <br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      &quot;templateLink&quot;: { <br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      &quot;uri&quot;: &quot;[variables('templatelink')]&quot;, <br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      &quot;contentVersion&quot;: &quot;1.0.0.0&quot; <br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }, <br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      &quot;parameters&quot;: { <br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      &quot;StorageAccountName&quot;: { <br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      &quot;value&quot;: &quot;[parameters('storageAccountName')]&quot; <br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } <br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } <br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } <br>
      &nbsp;&nbsp;&nbsp; } <br>
      ], </p>
  </blockquote>
</div>
</p>
<br><p>The URI resolves to a template named  either&nbsp;<strong>existingStorageAccount.json</strong>&nbsp;or&nbsp;<strong>newStorageAccount.json</strong>.  Create templates for those URIs. The following example shows the&nbsp;<strong>existingStorageAccount.json</strong>&nbsp;template.<br>
<div>
  <blockquote>
    <p>&quot;{ <br>
      &nbsp;      &quot;$schema&quot;:      &quot;https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#&quot;, <br>
      &nbsp;      &quot;contentVersion&quot;: &quot;1.0.0.0&quot;, <br>
      &nbsp;      &quot;parameters&quot;: { <br>
      &nbsp;&nbsp;&nbsp;      &quot;storageAccountName&quot;: { <br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      &quot;type&quot;: &quot;String&quot; <br>
      &nbsp;&nbsp;&nbsp; } <br>
      &nbsp; }, <br>
      &quot;variables&quot;: {}, <br>
      &nbsp;      &quot;resources&quot;: [], <br>
      &nbsp;      &quot;outputs&quot;: { <br>
      &nbsp;&nbsp;&nbsp;      &quot;storageAccountInfo&quot;: { <br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      &quot;value&quot;:      &quot;[reference(concat('Microsoft.Storage/storageAccounts/',      parameters('storageAccountName')),providers('Microsoft.Storage',      'storageAccounts').apiVersions[0])]&quot;, <br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      &quot;type&quot; : &quot;object&quot; <br>
      &nbsp;&nbsp;&nbsp; } <br>
      &nbsp; } <br>
      } </p>
  </blockquote>
</div>
<p>&nbsp;</p>
</br><p>The next example shows the&nbsp;<strong>newStorageAccount.json</strong>&nbsp;template.  Notice that like the existing storage account template the storage account  object is returned in the outputs. The master template works with either linked  template.<br>
</p>
<div>
  <blockquote>
    <p>{ <br>
      &nbsp;      &quot;$schema&quot;:      &quot;https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#&quot;, <br>
      &nbsp;      &quot;contentVersion&quot;: &quot;1.0.0.0&quot;, <br>
      &nbsp;      &quot;parameters&quot;: { <br>
      &nbsp;&nbsp;&nbsp;      &quot;storageAccountName&quot;: { <br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;type&quot;:      &quot;string&quot; <br>
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp; } <br>
      &nbsp; }, <br>
      resources&quot;: [ <br>
      &nbsp;&nbsp;&nbsp; { <br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      &quot;type&quot;: &quot;Microsoft.Storage/storageAccounts&quot;, <br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      &quot;name&quot;: &quot;[parameters('StorageAccountName')]&quot;, <br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      &quot;apiVersion&quot;: &quot;2016-01-01&quot;, <br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      &quot;location&quot;: &quot;[resourceGroup().location]&quot;, <br>
      sku&quot;: { <br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      &quot;name&quot;: &quot;Standard_LRS&quot; <br>
      }, <br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      &quot;kind&quot;: &quot;Storage&quot;, <br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      &quot;properties&quot;: { <br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } <br>
      &nbsp;&nbsp;&nbsp; } <br>
      &nbsp; ], <br>
      &nbsp;      &quot;outputs&quot;: { <br>
      &nbsp;&nbsp;&nbsp;      &quot;storageAccountInfo&quot;: { <br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      &quot;value&quot;:      &quot;[reference(concat('Microsoft.Storage/storageAccounts/',      parameters('StorageAccountName')),providers('Microsoft.Storage',      'storageAccounts').apiVersions[0])]&quot;, <br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      &quot;type&quot; : &quot;object&quot; <br>
      &nbsp;&nbsp;&nbsp; } <br>
      &nbsp; } <br>
      } </p>
    <p>&nbsp;</p>
  </blockquote>
</div>

